<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Trait that allows user specified configuration for various items during interpretation. Additionally, the types implementing this trait can act as custom user data within an interpreter instance, passed along to each method of this trait and host functions whenever they are invoked."><title>Config in wasm::config - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="wasm" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.1 (ed61e7d7e 2025-11-07) (built from a source tarball)" data-channel="1.91.1" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Config</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../wasm/index.html">wasm</a><span class="version">0.2.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Config</a></h2><h3><a href="#provided-associated-consts">Provided Associated Constants</a></h3><ul class="block"><li><a href="#associatedconstant.MAX_CALL_STACK_SIZE" title="MAX_CALL_STACK_SIZE">MAX_CALL_STACK_SIZE</a></li><li><a href="#associatedconstant.MAX_VALUE_STACK_SIZE" title="MAX_VALUE_STACK_SIZE">MAX_VALUE_STACK_SIZE</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.get_cost_per_element" title="get_cost_per_element">get_cost_per_element</a></li><li><a href="#method.get_fc_extension_cost_per_element" title="get_fc_extension_cost_per_element">get_fc_extension_cost_per_element</a></li><li><a href="#method.get_fc_extension_flat_cost" title="get_fc_extension_flat_cost">get_fc_extension_flat_cost</a></li><li><a href="#method.get_fd_extension_flat_cost" title="get_fd_extension_flat_cost">get_fd_extension_flat_cost</a></li><li><a href="#method.get_flat_cost" title="get_flat_cost">get_flat_cost</a></li><li><a href="#method.instruction_hook" title="instruction_hook">instruction_hook</a></li></ul><h3><a href="#foreign-impls">Implementations on Foreign Types</a></h3><ul class="block"><li><a href="#impl-Config-for-()" title="()">()</a></li></ul><h3><a href="#dyn-compatibility">Dyn Compatibility</a></h3><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In wasm::<wbr>config</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">wasm</a>::<wbr><a href="index.html">config</a></div><h1>Trait <span class="trait">Config</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/wasm/execution/config.rs.html#7-93">Source</a> </span></div><pre class="rust item-decl"><code>pub trait Config {
    const <a href="#associatedconstant.MAX_VALUE_STACK_SIZE" class="constant">MAX_VALUE_STACK_SIZE</a>: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.usize.html">usize</a> = 983_040usize;
    const <a href="#associatedconstant.MAX_CALL_STACK_SIZE" class="constant">MAX_CALL_STACK_SIZE</a>: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.usize.html">usize</a> = 4_096usize;

    // Provided methods
    fn <a href="#method.instruction_hook" class="fn">instruction_hook</a>(&amp;mut self, bytecode: &amp;[<a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u8.html">u8</a>], pc: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.usize.html">usize</a>) { ... }
<span class="item-spacer"></span>    fn <a href="#method.get_flat_cost" class="fn">get_flat_cost</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u8.html">u8</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.get_fc_extension_flat_cost" class="fn">get_fc_extension_flat_cost</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.get_fd_extension_flat_cost" class="fn">get_fd_extension_flat_cost</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.get_cost_per_element" class="fn">get_cost_per_element</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u8.html">u8</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.get_fc_extension_cost_per_element" class="fn">get_fc_extension_cost_per_element</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a> { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Trait that allows user specified configuration for various items during interpretation. Additionally, the types
implementing this trait can act as custom user data within an interpreter instance, passed along to each method of
this trait and host functions whenever they are invoked.</p>
<p>The default implementation of all trait methods have the least overhead, i. e. most can be optimized out fully.</p>
</div></details><h2 id="provided-associated-consts" class="section-header">Provided Associated Constants<a href="#provided-associated-consts" class="anchor">§</a></h2><div class="methods"><details class="toggle" open><summary><section id="associatedconstant.MAX_VALUE_STACK_SIZE" class="method"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#9">Source</a><h4 class="code-header">const <a href="#associatedconstant.MAX_VALUE_STACK_SIZE" class="constant">MAX_VALUE_STACK_SIZE</a>: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.usize.html">usize</a> = 983_040usize</h4></section></summary><div class="docblock"><p>Maximum number of values in the value stack</p>
</div></details><details class="toggle" open><summary><section id="associatedconstant.MAX_CALL_STACK_SIZE" class="method"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#12">Source</a><h4 class="code-header">const <a href="#associatedconstant.MAX_CALL_STACK_SIZE" class="constant">MAX_CALL_STACK_SIZE</a>: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.usize.html">usize</a> = 4_096usize</h4></section></summary><div class="docblock"><p>Maximum number of cascading function invocations</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.instruction_hook" class="method"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#20">Source</a><h4 class="code-header">fn <a href="#method.instruction_hook" class="fn">instruction_hook</a>(&amp;mut self, bytecode: &amp;[<a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u8.html">u8</a>], pc: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>A hook which is called before every wasm instruction</p>
<p>This allows the most intricate insight into the interpreters behavior, at the cost of a
hefty performance penalty</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.get_flat_cost" class="method"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#27-29">Source</a><h4 class="code-header">fn <a href="#method.get_flat_cost" class="fn">get_flat_cost</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u8.html">u8</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a></h4></section></summary><div class="docblock"><p>Amount of fuel to be deducted when a single byte <code>instr</code> is hit. The cost corresponding to <code>UNREACHABLE</code> and
<code>END</code> instructions and other bytes that do not correspond to any Wasm instruction are ignored.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.get_fc_extension_flat_cost" class="method"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#38-40">Source</a><h4 class="code-header">fn <a href="#method.get_fc_extension_flat_cost" class="fn">get_fc_extension_flat_cost</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a></h4></section></summary><div class="docblock"><p>Amount of fuel to be deducted when a multi-byte instruction that starts with the byte 0xFC is hit. This method
should return the cost of an instruction obtained by prepending 0xFC to of an unsigned 32-bit LEB
representation of <code>instr</code>. Multi-byte sequences obtained this way that do not correspond to any Wasm instruction
are ignored.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.get_fd_extension_flat_cost" class="method"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#49-51">Source</a><h4 class="code-header">fn <a href="#method.get_fd_extension_flat_cost" class="fn">get_fd_extension_flat_cost</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a></h4></section></summary><div class="docblock"><p>Amount of fuel to be deducted when a multi-byte instruction that starts with the byte 0xFD is hit. This method
should return the cost of an instruction obtained by prepending 0xFD to of an unsigned 32-bit LEB
representation of <code>instr</code>. Multi-byte sequences obtained this way that do not correspond to any Wasm instruction
are ignored.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.get_cost_per_element" class="method"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#65-67">Source</a><h4 class="code-header">fn <a href="#method.get_cost_per_element" class="fn">get_cost_per_element</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u8.html">u8</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a></h4></section></summary><div class="docblock"><p>Amount of fuel to be deducted per element of a single byte instruction <code>instr</code> that executes in asymptotically
linear time with respect to one of the values it pops from the stack.</p>
<p>In Wasm 2.0 specification, this applies to the following instructions:</p>
<ul>
<li><code>MEMORY.GROW</code> of type <code>[n: i32] -&gt; [i32]</code></li>
</ul>
<p>The cost of the instruction is calculated as <code>cost := get_flat_cost(instr) + n*get_cost_per_element(instr)</code>.
where <code>n</code> is the stack value marked in the instruction type signature above. Other instructions and bytes that
do not correspond to any instruction are ignored.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.get_fc_extension_cost_per_element" class="method"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#90-92">Source</a><h4 class="code-header">fn <a href="#method.get_fc_extension_cost_per_element" class="fn">get_fc_extension_cost_per_element</a>(_instr: <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.u32.html">u32</a></h4></section></summary><div class="docblock"><p>Amount of fuel to be deducted per element of a  multi-byte instruction that starts with the byte 0xFC,
which executes in asymptotically linear time with respect to one of the values it pops from the stack. This
method should return the cost of an instruction obtained by prepending 0xFD to of an unsigned 32-bit LEB
representation of <code>instr</code>. Multi-byte sequences obtained this way that do not correspond to any Wasm instruction
are ignored.</p>
<p>In Wasm 2.0 specification, this applies to the following instructions:</p>
<ul>
<li><code>MEMORY.INIT x</code>  of type <code>[d:i32 s: i32 n: i32] -&gt; []</code></li>
<li><code>MEMORY.FILL</code>    of type <code>[d: i32 val: i32 n: i32] -&gt; []</code></li>
<li><code>MEMORY.COPY</code>    of type <code>[d: i32 s: i32 n: i32] -&gt; []</code></li>
<li><code>TABLE.GROW x</code>   of type <code>[val: ref n: i32] -&gt; [i32]</code></li>
<li><code>TABLE.INIT x y</code> of type <code>[d: i32 s: i32 n: i32] -&gt; []</code></li>
<li><code>TABLE.FILL x</code>   of type <code>[i: i32 val: ref n: i32] -&gt; []</code></li>
<li><code>TABLE.COPY x y</code> of type <code>[d: i32 s: i32 n: i32] -&gt; []</code></li>
</ul>
<p>The cost of the instruction is calculated as <code>cost := get_flat_cost(instr) + n*get_cost_per_element(instr)</code>.
where <code>n</code> is the stack value marked in the instruction type signature above. Other instructions and multi-byte
sequences that do not correspond to any instruction are ignored.</p>
</div></details></div><h2 id="dyn-compatibility" class="section-header">Dyn Compatibility<a href="#dyn-compatibility" class="anchor">§</a></h2><div class="dyn-compatibility-info"><p>This trait is <b>not</b> <a href="https://doc.rust-lang.org/1.91.1/reference/items/traits.html#dyn-compatibility">dyn compatible</a>.</p><p><i>In older versions of Rust, dyn compatibility was called "object safety", so this trait is not object safe.</i></p></div><h2 id="foreign-impls" class="section-header">Implementations on Foreign Types<a href="#foreign-impls" class="anchor">§</a></h2><section id="impl-Config-for-()" class="impl"><a class="src rightside" href="../../src/wasm/execution/config.rs.html#96">Source</a><a href="#impl-Config-for-()" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Config.html" title="trait wasm::config::Config">Config</a> for <a class="primitive" href="https://doc.rust-lang.org/1.91.1/core/primitive.unit.html">()</a></h3><div class="docblock"><p>Default implementation of the interpreter configuration, with all hooks empty</p>
</div></section><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"></div><script src="../../trait.impl/wasm/execution/config/trait.Config.js" data-ignore-extern-crates="core" async></script></section></div></main></body></html>